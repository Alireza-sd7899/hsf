<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Alireza Sadeghi 400793389">
<meta name="author" content="Abishek Verma">
<meta name="author" content="Nimara Umer">
<meta name="keywords" content="Strategic thinking, Vision and oriented skills, Cognitive skills">
<meta name="description" content="DATA SCIENCE, ALIREZA SADEGHI">

<title>Strategic Thinking Skills Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="Final_files/libs/clipboard/clipboard.min.js"></script>
<script src="Final_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Final_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Final_files/libs/quarto-html/popper.min.js"></script>
<script src="Final_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Final_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Final_files/libs/quarto-html/quarto-syntax-highlighting-226bd0f977fa82dfae4534cac220d79a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Final_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Final_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Final_files/libs/bootstrap/bootstrap-f1599c2b719f74af44842847be30697a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="_extensions/apaquarto/apa.css">
</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#section-guideline" id="toc-section-guideline" class="nav-link active" data-scroll-target="#section-guideline">Section guideline</a>
  <ul class="collapse">
  <li><a href="#section-1-introduction" id="toc-section-1-introduction" class="nav-link" data-scroll-target="#section-1-introduction">Section 1 (Introduction)</a></li>
  <li><a href="#section-2-methodology" id="toc-section-2-methodology" class="nav-link" data-scroll-target="#section-2-methodology">Section 2 (Methodology)</a></li>
  <li><a href="#section-3-participants" id="toc-section-3-participants" class="nav-link" data-scroll-target="#section-3-participants">Section 3 (Participants)</a></li>
  <li><a href="#section-4-measures" id="toc-section-4-measures" class="nav-link" data-scroll-target="#section-4-measures">Section 4 (Measures)</a></li>
  <li><a href="#section-5-r-squared-changes-bar-plot-replication" id="toc-section-5-r-squared-changes-bar-plot-replication" class="nav-link" data-scroll-target="#section-5-r-squared-changes-bar-plot-replication">Section 5 (R-squared Changes Bar Plot Replication)</a></li>
  <li><a href="#section-6-procedure" id="toc-section-6-procedure" class="nav-link" data-scroll-target="#section-6-procedure">Section 6 (Procedure)</a></li>
  <li><a href="#section-7pull-request" id="toc-section-7pull-request" class="nav-link" data-scroll-target="#section-7pull-request">Section 7(Pull request)</a></li>
  <li><a href="#section-8-challenges-encountered" id="toc-section-8-challenges-encountered" class="nav-link" data-scroll-target="#section-8-challenges-encountered">Section 8 (Challenges <strong>Encountered</strong>)</a></li>
  <li><a href="#section-9-conclusion" id="toc-section-9-conclusion" class="nav-link" data-scroll-target="#section-9-conclusion">Section 9 (Conclusion)</a></li>
  <li><a href="#section-10-limitation-and-future-directions" id="toc-section-10-limitation-and-future-directions" class="nav-link" data-scroll-target="#section-10-limitation-and-future-directions">Section 10 (Limitation and future directions)</a></li>
  <li><a href="#section-11-workflow-and-teamwork" id="toc-section-11-workflow-and-teamwork" class="nav-link" data-scroll-target="#section-11-workflow-and-teamwork">Section 11 (workflow and teamwork)</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">2.Methodology</a></li>
  <li><a href="#participants" id="toc-participants" class="nav-link" data-scroll-target="#participants">3.Participants</a></li>
  <li><a href="#measures" id="toc-measures" class="nav-link" data-scroll-target="#measures">4.Measures</a></li>
  <li><a href="#procedure" id="toc-procedure" class="nav-link" data-scroll-target="#procedure">5.Procedure</a></li>
  <li><a href="#pull-request" id="toc-pull-request" class="nav-link" data-scroll-target="#pull-request">7.Pull request</a>
  <ul class="collapse">
  <li><a href="#challenges-encountered" id="toc-challenges-encountered" class="nav-link" data-scroll-target="#challenges-encountered"><strong>8.Challenges Encountered</strong></a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">9.Conclusion</a></li>
  </ul></li>
  <li><a href="#limitations-and-future-directions" id="toc-limitations-and-future-directions" class="nav-link" data-scroll-target="#limitations-and-future-directions">10.Limitations and Future Directions</a>
  <ul class="collapse">
  <li><a href="#what-i-could-not-solve" id="toc-what-i-could-not-solve" class="nav-link" data-scroll-target="#what-i-could-not-solve">What I Could Not Solve</a></li>
  <li><a href="#teamwork" id="toc-teamwork" class="nav-link" data-scroll-target="#teamwork">11.Teamwork</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  <li>Appendix</li>
  <li><a href="#apx-a" id="toc-apx-a" class="nav-link" data-scroll-target="#apx-a">This Section Is an Appendix</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Final.pdf"><i class="bi bi-file-pdf"></i>PDF (apaquarto)</a></li><li><a href="Final.docx"><i class="bi bi-file-word"></i>MS Word (apaquarto)</a></li><li><a href="Final.pdf"><i class="bi bi-file-pdf"></i>Typst (apaquarto)</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">




<br>

<br>

<section id="title" class="level1 title unnumbered unlisted">
<h1 class="title unnumbered unlisted">Strategic Thinking Skills Report: Hochschule Fresenius</h1>
<div class="Author">
<br>

<p>Alireza Sadeghi 400793389, Abishek Verma, and Nimara Umer</p>
<p>Department of Management, Hochschule Fresenius</p>
</div>
<br>

<br>

</section>
<section id="author-note" class="level1 unnumbered unlisted AuthorNote">
<h1 class="unnumbered unlisted AuthorNote">Author Note</h1>
<p>Alireza Sadeghi 400793389 <img src="_extensions/apaquarto/ORCID-iD_icon-vector.svg" id="orchid" class="img-fluid" style="width:4.23mm" alt="Orcid ID Logo: A green circle with white letters ID"> <a href="https://orcid.org/0000-0000-0000-0001">https://orcid.org/0000-0000-0000-0001</a></p>
<p>Correspondence concerning this article should be addressed to Alireza Sadeghi 400793389, Department of Management, Hochschule Fresenius</p>
<br>
</section>
<section id="abstract" class="level1 unnumbered unlisted AuthorNote">
<h1 class="unnumbered unlisted AuthorNote">Abstract</h1>
<div class="AbstractFirstParagraph">
<p>This paper offers a personal reflection on the development of strategic thinking skills through the completion of a data visualization and analysis project in RStudio. By navigating a multi-step workflow — including data preparation, graphical interpretation, GitHub collaboration, and technical rendering — I learned to plan beyond immediate tasks and consider long-term structure, clarity, and reproducibility. Strategic thinking was essential when selecting how to display gender-based differences in cognitive performance, choosing the most effective plot designs, and troubleshooting rendering issues during PDF export. The process also required prioritization, such as deciding when to pursue automation versus manual plotting due to time constraints. Furthermore, managing a Git-tracked workflow challenged me to think not only about the code itself, but about how to document and communicate it to others. This experience demonstrated that effective data work is not just about technical correctness, but about anticipating obstacles, making informed decisions, and delivering a coherent narrative from start to finish.</p>
</div>
<p><em>Keywords</em>: Strategic thinking, Vision and oriented skills, Cognitive skills</p>
<br>
</section>
<section id="firstheader" class="level1 title unnumbered unlisted">
<h1 class="title unnumbered unlisted">Strategic Thinking Skills Report: Hochschule Fresenius</h1>
</section>
<section id="section-guideline" class="level1">
<h1>Section guideline</h1>
<section id="section-1-introduction" class="level3">
<h3 data-anchor-id="section-1-introduction">Section 1 (Introduction)</h3>
<p>Introduces the overall goal of the replication, focusing on reproducing key visualizations and analyses related to gender differences in cognitive and behavioral scores. Explains the motivation for using the apaquarto style and setting up the R environment for reproducible research.</p>
<hr>
</section>
<section id="section-2-methodology" class="level3">
<h3 data-anchor-id="section-2-methodology">Section 2 (Methodology)</h3>
<p>Describes the manual construction of the dataset containing scores (BI score, HOR score, Eyes Test score, IST Score) stratified by gender and various categorical levels. Discusses how the data frame was structured to include mean scores and confidence intervals (lower and upper bounds) for each group.</p>
<hr>
</section>
<section id="section-3-participants" class="level3">
<h3 data-anchor-id="section-3-participants">Section 3 (Participants)</h3>
<p>The study included male and female participants assessed on multiple cognitive measures (BI score, HOR score, Eyes Test, and IST Score) across various performance levels. The sample size and distribution allowed for comparison of mean scores and confidence intervals between genders across these measures.</p>
<hr>
</section>
<section id="section-4-measures" class="level3">
<h3 data-anchor-id="section-4-measures">Section 4 (Measures)</h3>
<p>Cognitive performance was evaluated using four key measures: BI score, HOR score, Eyes Test score, and IST Score. Each measure was analyzed across different performance levels, with comparisons made between males and females to assess differences in mean scores and variability.</p>
<hr>
</section>
<section id="section-5-r-squared-changes-bar-plot-replication" class="level3">
<h3 data-anchor-id="section-5-r-squared-changes-bar-plot-replication">Section 5 (R-squared Changes Bar Plot Replication)</h3>
<p>Documents the replication of the Stata-style bar plot illustrating incremental changes in R-squared values across nested regression models for females. Discusses the creation of a simple dataset, plotting with text labels, and formatting choices like angle adjustments and minimal themes.</p>
<hr>
</section>
<section id="section-6-procedure" class="level3">
<h3 data-anchor-id="section-6-procedure">Section 6 (Procedure)</h3>
<p>Outlines fitting a linear regression model with interaction terms to assess the effects of gender, measure, and level on mean scores. Discusses the rationale for including interaction effects and reviewing model summaries for interpretation.</p>
</section>
<section id="section-7pull-request" class="level3">
<h3 data-anchor-id="section-7pull-request">Section 7(Pull request)</h3>
<p>This section will be explained about the procedure of Pull request.</p>
<hr>
</section>
<section id="section-8-challenges-encountered" class="level3">
<h3 data-anchor-id="section-8-challenges-encountered">Section 8 (Challenges <strong>Encountered</strong>)</h3>
<p>Candidly reports any challenges encountered during replication, such as manual data entry, ensuring accurate factor levels for plotting, or aligning graphical elements. Includes any troubleshooting steps taken to resolve these issues.</p>
<hr>
</section>
<section id="section-9-conclusion" class="level3">
<h3 data-anchor-id="section-9-conclusion">Section 9 (Conclusion)</h3>
<p>Summarizes the successful replication of key visualizations and statistical models, highlighting insights into gender differences across cognitive and behavioral measures. Suggests potential extensions or improvements for future research.</p>
<hr>
</section>
<section id="section-10-limitation-and-future-directions" class="level3">
<h3 data-anchor-id="section-10-limitation-and-future-directions">Section 10 (Limitation and future directions)</h3>
<p>Reflects on the Limitations and decisions we could have make</p>
</section>
<section id="section-11-workflow-and-teamwork" class="level3">
<h3 data-anchor-id="section-11-workflow-and-teamwork">Section 11 (workflow and teamwork)</h3>
<p>Team’s work and the presentation files.</p>
<p>In this section there is the Presentation file.</p>
<hr>
<p><strong>1)Introdction</strong></p>
<p>This project investigates how strategic thinking,specifically, Higher-Order Rationality (HOR) and Backward Induction (BI)—influences economic decision-making at both individual and household levels. Using large-scale data from the Singapore Life Panel and Korean Labor and Income Panel Study, the study demonstrates that strategic skills strongly correlate with income levels, household coordination, and gendered patterns in labor participation. The report aims to bridge behavioral game theory and labor economics, offering insights for educators, employers, and policymakers.</p>
<p>It introduces practical implications for hiring, education, and economic policy while highlighting the nuanced gendered outcomes embedded in the labor market structure.</p>
<hr>
<p><strong>Motive</strong>:</p>
<p>During an in-class review session, the professor encouraged me to take the replication further by not just generating static plots, but by learning how to properly render the full analysis into a formatted document — ideally a reproducible PDF. While my initial focus had been on plotting gender-based score differences using <code>ggplot2</code><span class="citation" data-cites="Wickham2016">(<a href="#ref-Wickham2016" role="doc-biblioref">Wickham, 2016b</a>)</span>, the suggestion made me realize that presenting the work cleanly in a report format is just as important as generating the figures themselves. I was also advised to ensure that the plots were exported at high quality and placed consistently throughout the report, with captions and labeling that would make the results accessible to any reader. This turned out to be more difficult than I expected. Rendering plots correctly into PDF using Quarto or R Markdown was especially challenging, as formatting often broke or images came out misaligned, too small, or even missing altogether. I had to experiment with different chunk options, DPI settings, and file paths to ensure the figures displayed properly. The process made me appreciate how much of a technical skill it is just to get high-resolution images and outputs to appear where and how you want them particularly in a structured document like a PDF. This feedback changed how I approached the project, shifting my focus from just “making graphs” to thinking more seriously about how to communicate results clearly, cleanly, and reproducibly in a full report format.</p>
<p><strong>What the Graphs show</strong></p>
<p>The tables and graphs generated in this project present a clear and structured picture of how males and females differ in their performance across four cognitive measures: <strong>BI score</strong>, <strong>HOR score</strong>, <strong>Eyes Test score</strong>, and <strong>IST Score</strong>. Each of these measures is presented with mean scores for three different performance tiers (either 0/1/2+ or Bottom/Middle/Top third), along with upper and lower bounds, which represent confidence intervals.</p>
<p>By separating the visualizations by gender, it becomes easier to observe the within-gender differences across test types and also to draw broad comparisons between genders. The bar plots help visualize the average score for each group, while the error bars provide a sense of statistical uncertainty ,showing the range within which the true score is likely to fall.</p>
<p>For the male dataset, the graphs show a fairly consistent pattern: in all four measures, the mean scores increase across performance tiers. For example, in the BI score and IST Score, we see a clear upward trend as we move from the lowest to the highest level, with relatively narrow confidence intervals. This suggests that among men, those in higher performance brackets tend to score much higher than those in lower ones, and that the data supporting this trend is fairly robust.</p>
<p>In the female graphs, the same general upward trend is present, but the scores are noticeably lower than those of the male groups across almost all tests and levels. The difference is particularly visible in the BI and HOR scores, where the top-tier female scores are still lower than the middle-tier male scores. This pattern might suggest a systematic difference in how males and females perform on these tests or could reflect underlying sampling, demographic, or psychometric factors not captured in this dataset.</p>
<p>The confidence intervals are also informative. In most cases, the error bars for males are relatively tight, indicating higher precision, while the female error bars are slightly wider , suggesting more variability or possibly a smaller sample size. However, the intervals generally do not overlap between the lowest and highest tiers, which strengthens the conclusion that there are significant differences in performance within each gender group.</p>
<p>In short, the graphs show that:</p>
<p>Cognitive scores increase across tiers for both males and females.Males generally score higher on average across all four tests.The data is consistent enough (based on the narrow intervals) to support these trends,There is a noticeable gender gap in cognitive performance that holds across multiple measures . These visualizations make the differences tangible and easy to interpret. They are especially useful for highlighting both relative improvement within each gender and absolute gaps between genders, giving a richer view than raw numbers alone.</p>
</section>
<section id="methodology" class="level3">
<h3 data-anchor-id="methodology">2.Methodology</h3>
<p><strong>Fig9</strong>:(Alireza)<br>
<strong>Data Preparation:</strong> A dataset was manually created in R containing the R-squared values from multiple regression models applied to a female subsample. This step became necessary because the original dataset, <code>slp</code><span class="citation" data-cites="choi2025">(<a href="#ref-choi2025" role="doc-biblioref">Choi et al., 2025</a>)</span>, was in Stata format and could not be directly used in R for this purpose. Despite extensive time spent troubleshooting and attempting to import or convert the Stata data, these efforts were unsuccessful. As a result, the R-squared values were manually compiled into a new dataset in R. This dataset included a categorical variable <code>model</code><span class="citation" data-cites="choi2025">(<a href="#ref-choi2025" role="doc-biblioref">Choi et al., 2025</a>)</span> describing each nested model specification, ranging from socio-demographics alone to the addition of educational, cognitive, and behavioral traits. A numeric variable <code>r_squared</code><span class="citation" data-cites="chicco2021">(<a href="#ref-chicco2021" role="doc-biblioref">Chicco et al., 2021</a>)</span> held the corresponding R-squared values for each model.</p>
<p><strong>Visualization:</strong> To visualize the incremental changes in R-squared across models, a bar plot was generated using the <strong>ggplot2</strong><span class="citation" data-cites="wickham2007">(<a href="#ref-wickham2007" role="doc-biblioref">Wickham et al., 2007</a>)</span> package. Each bar represented the R-squared value for one of the six nested models, with bars colored in a uniform gray tone for simplicity. Numeric R-squared values were displayed above each bar for clarity. The x-axis labels (model names) were rotated at a 30-degree angle to enhance readability. The plot featured a minimalist theme with a centered title and no x-axis label to focus attention on the model names and R-squared values.</p>
<p><strong>Export:</strong> The plot could be saved as a PNG image using the <code>ggsave</code><span class="citation" data-cites="wickham2007">(<a href="#ref-wickham2007" role="doc-biblioref">Wickham et al., 2007</a>)</span> function for inclusion in reports or presentations.</p>
</section>
<section id="participants" class="level2">
<h2 data-anchor-id="participants">3.Participants</h2>
<p>The analysis focused on a female subsample drawn from the original <code>slp</code><span class="citation" data-cites="choi2025">(<a href="#ref-choi2025" role="doc-biblioref">Choi et al., 2025</a>)</span> dataset, which contains individual-level data on socio-demographic, educational, cognitive, and behavioral characteristics. The participants were adult women, although additional demographic details are not specified here due to limitations in accessing the original dataset format.</p>
</section>
<section id="measures" class="level2">
<h2 data-anchor-id="measures">4.Measures</h2>
<p>The primary measure used to evaluate model performance was the <strong>R-squared</strong><span class="citation" data-cites="chicco2021">(<a href="#ref-chicco2021" role="doc-biblioref">Chicco et al., 2021</a>)</span> statistic from multiple linear regression models. R-squared represents the proportion of variance in the dependent variable explained by the predictors included in each model. The models were nested, starting with socio-demographic variables and progressively adding educational, cognitive, and behavioral traits. The increase in R-squared values across models was used to assess the incremental contribution of each group of predictors to the overall explanatory power of the model.</p>
</section>
<section id="procedure" class="level2">
<h2 data-anchor-id="procedure">5.Procedure</h2>
<p>The analysis focused on assessing the explanatory power of various predictors on a dependent variable using multiple linear regression models. Due to issues importing the original Stata dataset (<code>slp</code><span class="citation" data-cites="choi2025">(<a href="#ref-choi2025" role="doc-biblioref">Choi et al., 2025</a>)</span>) into R—despite significant time spent troubleshooting—the required data (R-squared values from prior regression outputs) was manually entered into a new dataset within R.</p>
<p>A series of <strong>six nested regression models</strong> were specified, each incrementally adding a set of predictors. The first model included only socio-demographic variables, while subsequent models introduced educational, cognitive, and behavioral traits in a stepwise fashion. This nesting allowed for a comparison of how each block of variables contributed to the model’s explanatory power.</p>
<p>R-squared values from each model were recorded in the manually constructed dataset, along with a categorical label identifying each model specification. These values were then visualized using the <strong>ggplot2</strong><span class="citation" data-cites="Wickham2016">(<a href="#ref-Wickham2016" role="doc-biblioref">Wickham, 2016b</a>)</span> package in R, with a minimalist bar plot designed to highlight the incremental increases in explained variance. The final visualization was prepared for export using <code>ggsave</code><span class="citation" data-cites="wickham2007">(<a href="#ref-wickham2007" role="doc-biblioref">Wickham et al., 2007</a>)</span> for potential inclusion in reports or presentations.</p>
<hr>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_files/figure-html/unnamed-chunk-1-1.svg" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required library</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>r2_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">factor</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Socio-Demographics (A)"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">"A &amp; Educ, IST, and Eyes Test (B)"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">"A, B &amp; Non-cognitive Traits (C)"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">"A, B, C &amp; BI"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">"A, B, C &amp; HOR"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"A, B, C, BI &amp; HOR"</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Socio-Demographics (A)"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">"A &amp; Educ, IST, and Eyes Test (B)"</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>      <span class="st">"A, B &amp; Non-cognitive Traits (C)"</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">"A, B, C &amp; BI"</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      <span class="st">"A, B, C &amp; HOR"</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="st">"A, B, C, BI &amp; HOR"</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">r_squared =</span> <span class="fu">c</span>(<span class="fl">0.051516</span>, <span class="fl">0.085</span>, <span class="fl">0.096</span>, <span class="fl">0.103</span>, <span class="fl">0.097</span>, <span class="fl">0.103</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar plot</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(r2_data, <span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> r_squared)) <span class="sc">+</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, r_squared)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Changes in R-squared for Females"</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"R-squared"</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Save the plot</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("figures/r_squared_females.png", width = 6, height = 4)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><strong>Data Preparation: Fig 9 (Alireza)</strong><br>
A synthetic dataset was created in R to explore how average scores across different cognitive and behavioral measures vary by gender and categorized performance levels. The dataset included four key measures: <strong>BI score</strong>, <strong>HOR score</strong>, <strong>Eyes Test score</strong>, and <strong>IST Score</strong>. For each measure, values were provided for both males and females across three categorical levels. These levels varied depending on the measure:</p>
<p>For <strong>BI score</strong>, levels were: <code>"0"</code>, <code>"1"</code>, and <code>"2+"</code>.</p>
<p>For the remaining measures (<strong>HOR</strong>, <strong>Eyes Test</strong>, and <strong>IST</strong>), levels represented performance terciles: <code>"Bottom 1/3"</code>, <code>"Middle 1/3"</code>, and <code>"Top 1/3"</code>.</p>
<p>Each entry in the dataset included:</p>
<p>The <strong>mean score</strong> for a given group (gender × level × measure),</p>
<p>The <strong>lower bound</strong> (<code>lb</code>) and <strong>upper bound</strong> (<code>ub</code>) of the confidence interval (or uncertainty range) around the mean.</p>
<p><strong>Data Subsetting:</strong><br>
The full dataset was split into two subsets for clearer visualization:</p>
<p>One subset (<code>df1</code>) included only the <strong>BI</strong> and <strong>HOR scores</strong>.</p>
<p>The second subset (<code>df2</code>) included the <strong>Eyes Test</strong> and <strong>IST scores</strong>.</p>
<p><strong>Visualization:</strong><br>
Two bar plots were created using the <strong>ggplot2</strong><span class="citation" data-cites="Wickham2016">(<a href="#ref-Wickham2016" role="doc-biblioref">Wickham, 2016b</a>)</span> package to illustrate mean scores by gender and level for each measure:</p>
<p>Each bar represented the mean score, grouped and color-coded by gender.</p>
<p>Error bars were added to represent the lower and upper bounds (<code>lb</code>, <code>ub</code>).</p>
<p>A <strong>facet wrap</strong> was used to create subplots by measure within each figure.</p>
<p>X-axis labels were rotated 45 degrees for readability.</p>
<p>A <strong>minimal theme</strong> was applied for a clean presentation, and plot titles were added to distinguish between the two parts:</p>
<ul>
<li><ul>
<li><p><em>Part 1:</em> BI &amp; HOR Scores by Gender and Level</p>
<p><em>Part 2:</em> Eyes Test &amp; IST Scores by Gender and Level</p></li>
</ul></li>
</ul>
<p><strong>Interpretation and Export:</strong><br>
These visualizations allow for intuitive comparison of gender differences across score levels and measures. While the dataset is illustrative and not drawn from raw data files, it reflects typical analytical patterns found in behavioral economics and cognitive psychology research. The resulting plots were intended for inclusion in presentations or reports and could be exported as images using <code>ggsave()</code><span class="citation" data-cites="wickham2007">(<a href="#ref-wickham2007" role="doc-biblioref">Wickham et al., 2007</a>)</span> if needed.</p>
<hr>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Final_files/figure-html/unnamed-chunk-3-2.svg" class="img-fluid figure-img" width="624"></p>
</figure>
</div>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your original df creation looks like this:</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"male"</span>, <span class="dv">12</span>), <span class="fu">rep</span>(<span class="st">"female"</span>, <span class="dv">12</span>)),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">measure =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"BI score"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"HOR score"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"Eyes Test score"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"IST Score"</span>, <span class="dv">3</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rep</span>(<span class="st">"BI score"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"HOR score"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"Eyes Test score"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"IST Score"</span>, <span class="dv">3</span>)),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"2+"</span>, <span class="st">"Bottom 1/3"</span>, <span class="st">"Middle 1/3"</span>, <span class="st">"Top 1/3"</span>, <span class="st">"Bottom 1/3"</span>, <span class="st">"Middle 1/3"</span>, <span class="st">"Top 1/3"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Bottom 1/3"</span>, <span class="st">"Middle 1/3"</span>, <span class="st">"Top 1/3"</span>, <span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"2+"</span>, <span class="st">"Bottom 1/3"</span>, <span class="st">"Middle 1/3"</span>, <span class="st">"Top 1/3"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Bottom 1/3"</span>, <span class="st">"Middle 1/3"</span>, <span class="st">"Top 1/3"</span>, <span class="st">"Bottom 1/3"</span>, <span class="st">"Middle 1/3"</span>, <span class="st">"Top 1/3"</span>)),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">lb =</span> <span class="fu">c</span>(<span class="fl">44931.305</span>, <span class="fl">54109.086</span>, <span class="fl">55480.535</span>, <span class="fl">45216.531</span>, <span class="fl">48002.105</span>, <span class="fl">58814.445</span>, <span class="fl">50066.574</span>, <span class="fl">52866.023</span>, <span class="fl">49313.242</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>         <span class="fl">35703.82</span>, <span class="fl">56006.551</span>, <span class="fl">61009.414</span>, <span class="fl">34252.043</span>, <span class="fl">30851.008</span>, <span class="fl">33478.758</span>, <span class="fl">28860.623</span>, <span class="fl">33940.754</span>, <span class="fl">35268.48</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>         <span class="fl">32507.17</span>, <span class="fl">33701.172</span>, <span class="fl">32089.473</span>, <span class="fl">20753.66</span>, <span class="fl">34339.328</span>, <span class="fl">42162.641</span>),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fu">c</span>(<span class="fl">51984.762</span>, <span class="fl">62801.484</span>, <span class="fl">66067.82</span>, <span class="fl">51927.395</span>, <span class="fl">57356.164</span>, <span class="fl">67887.992</span>, <span class="fl">58345.277</span>, <span class="fl">61292.324</span>, <span class="fl">58373.047</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>           <span class="fl">43203.984</span>, <span class="fl">64502.379</span>, <span class="fl">70366.406</span>, <span class="fl">40164.016</span>, <span class="fl">36671.625</span>, <span class="fl">41351.98</span>, <span class="fl">35161.988</span>, <span class="fl">39879.863</span>, <span class="fl">42191.738</span>,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>           <span class="fl">38914.367</span>, <span class="fl">39844.25</span>, <span class="fl">38714.75</span>, <span class="fl">24604.195</span>, <span class="fl">39638.992</span>, <span class="fl">50220.734</span>),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">ub =</span> <span class="fu">c</span>(<span class="fl">59038.219</span>, <span class="fl">71493.883</span>, <span class="fl">76655.109</span>, <span class="fl">58638.258</span>, <span class="fl">66710.219</span>, <span class="fl">76961.531</span>, <span class="fl">66623.984</span>, <span class="fl">69718.625</span>, <span class="fl">67432.852</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>         <span class="fl">50704.148</span>, <span class="fl">72998.211</span>, <span class="fl">79723.398</span>, <span class="fl">46075.984</span>, <span class="fl">42492.238</span>, <span class="fl">49225.203</span>, <span class="fl">41463.355</span>, <span class="fl">45818.973</span>, <span class="fl">49114.996</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>         <span class="fl">45321.563</span>, <span class="fl">45987.324</span>, <span class="fl">45340.023</span>, <span class="fl">28454.732</span>, <span class="fl">44938.656</span>, <span class="fl">58278.828</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>plot_scores <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title) {</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> level, <span class="at">y =</span> mean, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lb, <span class="at">ymax =</span> ub), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> measure, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title, <span class="at">x =</span> <span class="st">"Level"</span>, <span class="at">y =</span> <span class="st">"Mean Score"</span>) <span class="sc">+</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_scores</span>(<span class="fu">filter</span>(data_df, measure <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"BI score"</span>, <span class="st">"HOR score"</span>)), <span class="st">"Part 1: BI &amp; HOR Scores by Gender and Level"</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_scores</span>(<span class="fu">filter</span>(data_df, measure <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Eyes Test score"</span>, <span class="st">"IST Score"</span>)), <span class="st">"Part 2: Eyes Test &amp; IST Scores by Gender and Level"</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pull-request" class="level2">
<h2 data-anchor-id="pull-request">7.Pull request</h2>
<p>To contribute to the main repository and submit my replication work, I created a pull request using Git and GitHub by following a procedure by Chevis mbatha.<span class="citation" data-cites="mbatha2023github">(<a href="#ref-mbatha2023github" role="doc-biblioref">Mbatha, 2023</a>)</span>. First, I forked the original repository and cloned it to my local machine. After completing my replication tasks and ensuring all files were correctly structured and committed with meaningful messages, I pushed the changes to a separate branch on my forked repository. I then initiated a pull request on GitHub, clearly describing the changes made and the purpose of the update. This allowed project collaborators to review and merge my contribution into the main repository, ensuring transparency and version control in the workflow.</p>
<section id="challenges-encountered" class="level3">
<h3 data-anchor-id="challenges-encountered"><strong>8.Challenges Encountered</strong></h3>
<p>Although the dataset was relatively clean and the goal was clearly defined, several challenges emerged throughout the project , ranging from technical hurdles in R to workflow and GitHub integration. These challenges not only tested my coding skills but also taught valuable lessons in debugging, planning, and patience</p>
<p><strong>Data Formatting and Consistency</strong></p>
<p>The dataset appeared simple at first glance, but a few subtle issues created complications:</p>
<p>The dataset appeared simple at first glance, but a few subtle issues created complications:</p>
<p><strong>Improper Data Types</strong>: The <code>level</code> and <code>measure</code> columns were initially read as character vectors, which caused unwanted reordering in the plots. This required converting them to factors and manually setting their levels to control the display order.</p>
<p><strong>Floating-Point Precision</strong>: Some of the mean, lower bound, and upper bound values were truncated or stored as strings, requiring type conversion using <code>as.numeric()</code> in some cases.</p>
<p><strong>Non-Uniform Labels</strong>: Inconsistencies such as “Top 1/3” vs “Top ⅓” across datasets (from earlier testing) caused grouping failures in plots until standardized.</p>
<hr>
<p><strong>Visualization Logic and Syntax Errors</strong></p>
<p>Plotting with <code>ggplot2</code><span class="citation" data-cites="Wickham2016">(<a href="#ref-Wickham2016" role="doc-biblioref">Wickham, 2016b</a>)</span> offers flexibility, but it also requires attention to syntax and structure:</p>
<p><strong>Bar and Error Bar Misalignment</strong>: The initial charts had misaligned error bars because <code>position_dodge()</code><span class="citation" data-cites="Wickham2016">(<a href="#ref-Wickham2016" role="doc-biblioref">Wickham, 2016b</a>)</span> wasn’t applied consistently in both <code>geom_col()</code><span class="citation" data-cites="wickham2007">(<a href="#ref-wickham2007" role="doc-biblioref">Wickham et al., 2007</a>)</span> and <code>geom_errorbar()</code><span class="citation" data-cites="wickham2007">(<a href="#ref-wickham2007" role="doc-biblioref">Wickham et al., 2007</a>)</span>. Fixing this required trial-and-error.</p>
<p><strong>Facet Ordering</strong>: Without reordering the <code>measure</code> variable, the plot panels appeared alphabetically, which separated “Eyes Test score” from “IST Score” , reducing interpretability. Reordering with <code>factor(levels = ...)</code> was necessary to correct this.</p>
<p><strong>Overcrowded Facets</strong>: Initially, I tried displaying all genders and measures in one figure. This made the charts dense and hard to read, especially when labels overlapped. Ultimately, I separated the plots by gender, which made them cleaner and easier to interpret.</p>
<hr>
<p><strong>GitHub and Version Control Issues</strong></p>
<p>Using GitHub helped track changes, but it introduced several obstacles:</p>
<p><strong>Authentication Problems</strong>: GitHub’s newer token-based authentication system caused initial push failures. I had to create a Personal Access Token and store it securely using RStudio’s Git configuration.</p>
<p><strong>Pushing Unwanted Files</strong>: <code>.Rproj.user</code>, <code>.Rhistory</code>, and the CSV input file were unintentionally committed to the repository. Creating a <code>.gitignore</code> file fixed this, but only after clutter had been added to the Git history.</p>
<p><strong>File Path Confusion</strong>: When running the script on another computer, the file path to the CSV broke. This was resolved by using relative paths (<code>read_csv("data/Fig_A8_input.csv")</code>) and organizing files into a clean directory structure.</p>
<hr>
<p><strong>RStudio IDE Limitations</strong></p>
<p>As a beginner, RStudio itself presented a few unexpected hurdles:</p>
<p><strong>Console Errors Without Explanation</strong>: Some errors (e.g., “object not found”) were cryptic, especially when variables were filtered out or overwritten accidentally. I learned to use <code>str()</code> and <code>summary()</code>frequently to debug data issues.</p>
<p><strong>Slow Rendering</strong>: When attempting to include multiple plots in one output (e.g., <code>gridExtra</code> or <code>patchwork</code>), the rendering was noticeably slower, especially with many facets and high-resolution settings.</p>
<p><strong>Session Restarts</strong>: On a few occasions, RStudio crashed while plotting or rendering requiring me to restart the session and reload all packages.</p>
<hr>
<p><strong>Workflow Management and Planning</strong></p>
<p>Some of the most impactful challenges weren’t technical but rather organizational:</p>
<p><strong>Too Much in One Script</strong>: My early code was written as one long block. This made debugging difficult. I later modularized the code into chunks (e.g., one block for loading data, one for male plots, one for female).</p>
<p><strong>Lack of Inline Comments</strong>: Forgetting to comment code while writing meant I had to re-learn what I’d done when revisiting older parts of the script. Adding descriptive comments improved readability.</p>
<p><strong>Late GitHub Setup</strong>: I didn’t use GitHub from the start. This meant I lost the ability to track early development steps, including mistakes and how I fixed them.</p>
<hr>
<p><strong>Presentation Formatting</strong></p>
<p>Formatting the plots for inclusion in a report or presentation came with its own set of problems:</p>
<p><strong>Saving High-Quality Images</strong>: Using <code>ggsave()</code><span class="citation" data-cites="wickham2016">(<a href="#ref-wickham2016" role="doc-biblioref">Wickham, 2016a</a>)</span> required tuning the width, height, and DPI settings to avoid blurry or cropped charts.</p>
<p><strong>Plot Titles and Labels</strong>: Getting axis labels and legends to render consistently across all plots took several adjustments.</p>
<p><strong>Color Palette Conflicts</strong>: With multiple measures and both genders represented, some default color palettes created visual confusion. I eventually chose a consistent color scheme using <code>scale_fill_brewer()</code> for better contrast.</p>
<hr>
</section>
</section>
<section id="conclusion" class="level2">
<h2 data-anchor-id="conclusion">9.Conclusion</h2>
<p>This project successfully replicated gender-disaggregated cognitive score visualizations using R. The final charts provide a clear picture of gender-based differences in various psychometric tests. The process reinforced key R programming skills, especially in data visualization, factor handling, and project reproducibility. In addition to technical growth, the experience highlighted the importance of workflow management, documentation, and clean version control practices. Despite minor challenges, the replication was completed accurately and in line with best practices.</p>
</section>
</section>
<section id="limitations-and-future-directions" class="level1">
<h1>10.Limitations and Future Directions</h1>
<p>If given the opportunity to start this project again, I would make several improvements:</p>
<p><strong>Start with an R Project</strong>: Using an <code>.Rproj</code> file helps manage the environment and keeps files better organized.</p>
<p><strong>Automate the Pipeline</strong>: I would modularize the script into functions, especially for repeated steps like filtering data and creating plots. This would improve scalability and reusability.</p>
<p><strong>Use GitHub from the Beginning</strong>: Early Git tracking would have preserved the coding process more transparently.</p>
<p><strong>Explore Interactive Visuals</strong>: Incorporating <code>plotly</code><span class="citation" data-cites="wickham2019">(<a href="#ref-wickham2019" role="doc-biblioref">Wickham et al., 2019</a>)</span> or building a Shiny app could allow dynamic gender switching, filter controls, and a more interactive data exploration experience.</p>
<p><strong>Use Quarto</strong>: For future reports, Quarto would offer a better framework for literate programming and reproducibility.</p>
<hr>
<section id="what-i-could-not-solve" class="level3">
<h3 data-anchor-id="what-i-could-not-solve">What I Could Not Solve</h3>
<p>Although I was able to complete the main goals of the project namely, visualizing the gender-based differences in cognitive scores using R and producing clear plots with confidence intervals , there were a few things I was not able to solve, either due to time limitations, technical hurdles, or lack of experience.</p>
<p>One of the earliest obstacles I faced was not being able to access the original dataset used in the seminar, known as <em>slp</em>, which was provided in Stata (.dta) format. I tried multiple approaches to import this into R, including using the <code>haven</code><span class="citation" data-cites="wickham2015">(<a href="#ref-wickham2015" role="doc-biblioref">Wickham et al., 2015</a>)</span> package and online converters, but each attempt produced errors or incomplete tables. I spent a significant amount of time troubleshooting this issue ,exploring encoding settings, variable formats, and compatibility between Stata versions ,but none of the solutions worked in time. Unfortunately, by the time I realized I couldn’t resolve this on my own, it was too late in the process to ask for support from the professor or switch to a new data source. As a result, I had to manually reconstruct a simplified dataset in R based on the reported values for the female subsample, which limited the depth of my analysis.</p>
<p>One of the other limitations I faced was the inability to combine male and female plots into one integrated view that felt clean and interpretable. I attempted to use facet grids that split the data by both gender and measure, but the result was too visually busy and hard to read, especially with long factor names like “Top 1/3” or “Bottom 1/3” running across the x-axis. I had hoped to build a combined chart that allowed for side-by-side gender comparison within each cognitive test, but I didn’t manage to do that in a way that was both aesthetically pleasing and functional. Eventually, I settled on creating two separate plots , one for males and one for females ,which was a good compromise, but not exactly what I originally intended.</p>
<p>Another area I struggled with was automating the export of my plots. Although I managed to save the final graphs manually using <code>ggsave()</code><span class="citation" data-cites="wickham2016">(<a href="#ref-wickham2016" role="doc-biblioref">Wickham, 2016a</a>)</span>, I wanted to create a loop or script that would generate and save all plots automatically into named folders, such as “male_figures” and “female_figures.” This would have made the process more scalable and professional. I attempted to do this using simple for-loops and <code>paste0()</code> functions to generate file names, but I ran into several issues with overwriting plots, inconsistent sizing, and relative paths. Because of these issues and the time pressure I was under, I stuck with manually exporting each image one by one, which was time-consuming but guaranteed accuracy.</p>
<p>There were also some problems related to GitHub that I couldn’t fully solve. While I was able to push the main files and code to a GitHub repository, I didn’t succeed in keeping the project completely clean or well-organized. At the start, I accidentally committed unnecessary files like <code>.Rhistory</code>, <code>.Rproj.user</code>, and even the CSV dataset itself. I tried using <code>.gitignore</code> to filter these out, and although that helped, some of these files still ended up in my repo history. I also wanted to create a proper README file with instructions and a summary of the project, but I ran out of time and had to skip that step. I know GitHub can be used to make projects more reproducible and collaborative, but in my case, it was more of a last-minute backup system than a fully developed workflow.</p>
<p>Another thing I wanted to include in my graphs was annotation. specifically, to label each bar with its mean score and possibly even show the confidence interval as text. I tried using <code>geom_text()</code><span class="citation" data-cites="piras2010">(<a href="#ref-piras2010" role="doc-biblioref">Piras, 2010</a>)</span> for this purpose, but the placement of the labels was tricky. They overlapped with the bars, sometimes extended outside the facet boundaries, or just made the plot look too crowded. I also ran into issues where the labels weren’t scaling correctly across different facets. Eventually, I decided not to include them at all, reasoning that the error bars themselves communicated enough information. Still, I think better labeling would have made the plots more informative.</p>
<p>Finally, I had initially hoped to render the entire project . code, plots, and write-up as a single reproducible report using either R Markdown or Quarto. I did try setting up a <code>.qmd</code> file and writing the report in chunks, but I faced a number of rendering issues. Some code chunks failed during rendering because the variables they depended on were not available in the execution environment, even though they worked perfectly when run manually. Other times, the plot output would not fit within the page, or the formatting would break. These errors took too long to troubleshoot, and since I had already written my draft report in Word, I chose to finish that instead. I still think Quarto is a great tool for reproducibility, but I wasn’t ready to use it efficiently for this project.</p>
<p>All of these unsolved problems were frustrating at the time, but I see them now as part of the learning curve. They’ve helped me understand not just what I need to improve technically, but also what I might approach differently in future projects. While I was able to achieve my core goals, there’s a lot of room to improve when it comes to automation, visual polish, and professional workflow setup.</p>
<p>Here is the presentation link:</p>
<p>https://alireza-sd7899.github.io/testc/</p>
<hr>
</section>
<section id="teamwork" class="level3">
<h3 data-anchor-id="teamwork">11.Teamwork</h3>
<p>The project tasks were thoughtfully divided among the three of us, with each member contributing their strengths and showing great ambition and hard work. I completed two graphs and wrote my part of the report, Nimara also created two graphs and contributed her section of the report, and Abishek produced one graph along with his report segment. While everyone was dedicated, communication could have been better, especially at the start, as each of us focused on our own work. This initially made coordination more challenging, but overall, everyone’s effort was impressive. Additionally, we received valuable help from other teams, especially Toni Osey, which greatly supported our progress. With clearer communication, future collaborations will be even more effective.</p>
<hr>
</section>
<section id="references" class="level2">
<h2 data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-chicco2021" class="csl-entry" role="listitem">
Chicco, D., Warrens, M. J., &amp; Jurman, G. (2021). The coefficient of determination R-squared is more informative than SMAPE, MAE, MAPE, MSE and RMSE in regression analysis evaluation. <em>PeerJ Computer Science</em>, <em>7</em>, e623. <a href="https://doi.org/10.7717/peerj-cs.623">https://doi.org/10.7717/peerj-cs.623</a>
</div>
<div id="ref-choi2025" class="csl-entry" role="listitem">
Choi, S., Kim, S., &amp; Lim, W. (2025). Strategic Thinking Skills: A Key to Collective Economic Success. <em>American Economic Journal: Microeconomics</em>, <em>17</em>(2), 214–240. <a href="https://doi.org/10.1257/mic.20220259">https://doi.org/10.1257/mic.20220259</a>
</div>
<div id="ref-mbatha2023github" class="csl-entry" role="listitem">
Mbatha, C. (2023). <em>Make a pull request</em>. <a href="https://github.com/hubchev/make_a_pull_request" class="uri">https://github.com/hubchev/make_a_pull_request</a>.
</div>
<div id="ref-piras2010" class="csl-entry" role="listitem">
Piras, G. (2010). <span><strong>sphet</strong></span>: Spatial Models with Heteroskedastic Innovations in<span><em>R</em></span>. <em>Journal of Statistical Software</em>, <em>35</em>(1). <a href="https://doi.org/10.18637/jss.v035.i01">https://doi.org/10.18637/jss.v035.i01</a>
</div>
<div id="ref-wickham2016" class="csl-entry" role="listitem">
Wickham, H. (2016a). <em>ggplot2</em>. Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-24277-4">https://doi.org/10.1007/978-3-319-24277-4</a>
</div>
<div id="ref-Wickham2016" class="csl-entry" role="listitem">
Wickham, H. (2016b). <em>ggplot2: Elegant graphics for data analysis</em>. Springer-Verlag. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>
</div>
<div id="ref-wickham2019" class="csl-entry" role="listitem">
Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L., François, R., Grolemund, G., Hayes, A., Henry, L., Hester, J., Kuhn, M., Pedersen, T., Miller, E., Bache, S., Müller, K., Ooms, J., Robinson, D., Seidel, D., Spinu, V., … Yutani, H. (2019). Welcome to the tidyverse. <em>Journal of Open Source Software</em>, <em>4</em>(43), 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>
</div>
<div id="ref-wickham2007" class="csl-entry" role="listitem">
Wickham, H., Chang, W., Henry, L., Pedersen, T. L., Takahashi, K., Wilke, C., Woo, K., Yutani, H., Dunnington, D., &amp; Brand, T. van den. (2007). <em>ggplot2: Create elegant data visualisations using the grammar of graphics</em>. The R Foundation. <a href="https://doi.org/10.32614/cran.package.ggplot2">https://doi.org/10.32614/cran.package.ggplot2</a>
</div>
<div id="ref-wickham2015" class="csl-entry" role="listitem">
Wickham, H., Miller, E., &amp; Smith, D. (2015). <em>Haven: Import and export ’SPSS’, ’stata’ and ’SAS’ files</em>. The R Foundation. <a href="https://doi.org/10.32614/cran.package.haven">https://doi.org/10.32614/cran.package.haven</a>
</div>
</div>
<hr>
</section>
</section>
<section class="level1">
<h1>Appendix</h1>
</section>
<section id="apx-a" class="level1" data-appendixtitle="A">
<h1 data-appendixtitle="A">This Section Is an Appendix</h1>
<p>I affirm that this report was authored solely by me. All analysis, code, and visualizations were conducted independently using RStudio. Any external sources are fully cited. No portion of this report has been submitted elsewhere, and I agree to cooperate with any academic integrity investigations related to this project.</p>
<ul class="task-list">
<li><p><label><input type="checkbox" checked="">I wrote about 4000 words.</label></p></li>
<li><p><label><input type="checkbox" checked="">The submission contains the Quatro file of the report.</label></p></li>
<li><p><label><input type="checkbox" checked="">The submission contains the Quatro file of the presentation.</label></p>
<hr></li>
<li><p><label><input type="checkbox" checked="">The submission contains the HTML file of the report.</label></p></li>
<li><p><label><input type="checkbox" checked="">The submission contains the HTML file of the presentation.</label></p></li>
<li><p><label><input type="checkbox" checked="">The submission contains the PDF file of the report.</label></p></li>
<li><p><label><input type="checkbox" checked="">The submission contains the PDF file of the presentation.</label></p>
<hr></li>
<li><p><label><input type="checkbox" checked="">The title page of presentation and the report contain personal details.</label></p></li>
<li><p><label><input type="checkbox" checked="">The report contains an abstract.</label></p></li>
<li><p><label><input type="checkbox" checked="">The presentation and report contain a bibliograghy,created using BibTex with APA citation style.</label></p>
<hr></li>
<li><p><label><input type="checkbox" checked="">The report contains R code that proofs the students expertise in coding.</label></p></li>
<li><p><label><input type="checkbox" checked="">The report includes an Introduction to guide the reader and a conclusion summarizing the work and discussing potential further investigations and readings,respectively.</label></p></li>
<li><p><label><input type="checkbox" checked="">All significant resources used in the report and R code development.</label></p>
<hr></li>
<li><p><label><input type="checkbox" checked="">The filled out Affidavit.</label></p></li>
<li><p><label><input type="checkbox" checked="">A concise description of the successful use of Git and GitHub,as detailed …..</label></p></li>
<li><p><label><input type="checkbox" checked="">The link of the presentation and handout published on GitHub.</label></p>
<p>[Alireza Sadeghi,21/07/2025,Cologne]</p></li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>